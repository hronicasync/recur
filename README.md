# Recur Bot

Telegram –±–æ—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–æ–∫ –∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π —Å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìù –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ)
- üîî –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –ø–ª–∞—Ç–µ–∂–∞—Ö
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–¥–ø–∏—Å–∫–∞–º –∑–∞ –º–µ—Å—è—Ü
- üí∞ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –≤–∞–ª—é—Ç (RUB, USD, EUR, KZT, BYN)
- ‚è∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- üìÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Docker

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose
- Telegram Bot Token (–æ—Ç [@BotFather](https://t.me/BotFather))
- PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   ```bash
   git clone https://github.com/hronicasync/recur.git
   cd recur
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª:**
   ```bash
   cp .env.example .env
   ```

   –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```env
   BOT_TOKEN=your_telegram_bot_token
   POSTGRES_HOST=your_postgres_host
   POSTGRES_PORT=5432
   POSTGRES_USER=your_db_user
   POSTGRES_PASSWORD=your_db_password
   POSTGRES_DB=recur_bot
   DEFAULT_TZ=Europe/Moscow
   DEFAULT_NOTIFY_HOUR=16
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
   ```bash
   docker compose up -d
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   ```bash
   docker logs -f recur_bot
   ```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

- **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞:**
  ```bash
  docker compose down
  ```

- **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å:**
  ```bash
  docker compose restart
  ```

- **–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥:**
  ```bash
  git pull
  docker compose up -d --build
  ```

- **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:**
  ```bash
  docker logs recur_bot
  docker logs -f recur_bot  # —Å–ª–µ–¥–∏—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
  ```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–µ–∑ Docker

1. **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
   - Node.js 20+
   - PostgreSQL
   - PM2 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
   ```bash
   npm install
   ```

3. **–ó–∞–ø—É—Å–∫:**
   ```bash
   node node.js
   # –∏–ª–∏ —Å PM2
   pm2 start ecosystem.config.cjs
   ```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å SOCKS5 –ø—Ä–æ–∫—Å–∏

–ï—Å–ª–∏ Telegram –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –±–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ SOCKS5 –ø—Ä–æ–∫—Å–∏ `127.0.0.1:1080`.

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –ø—Ä–æ–∫—Å–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ [node.js](node.js#L76):
```javascript
const proxyAgent = new SocksProxyAgent('socks5://your-proxy:port');
```

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
- `/add` - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –ø–æ–¥–ø–∏—Å–∫—É
- `/list` - –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –ø–æ–¥–ø–∏—Å–∫–∏
- `/upcoming` - –°–ø–∏—Å–∞–Ω–∏—è –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ 7 –¥–Ω–µ–π
- `/month` - –û—Ç—á—ë—Ç –ø–æ —Ç–µ–∫—É—â–µ–º—É –º–µ—Å—è—Ü—É
- `/edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
- `/pay` - –û—Ç–º–µ—Ç–∏—Ç—å –æ–ø–ª–∞—Ç—É –≤—Ä—É—á–Ω—É—é
- `/delete` - –£–¥–∞–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
- `/reminders` - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
- `/dbstatus` - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
recur_bot/
‚îú‚îÄ‚îÄ node.js                 # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îú‚îÄ‚îÄ db.js                   # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îú‚îÄ‚îÄ reminderScheduler.js    # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
‚îú‚îÄ‚îÄ lib/                    # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ subscriptions.js    # –†–∞–±–æ—Ç–∞ —Å –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ users.js            # –†–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ events.js           # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ dates.js            # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –¥–∞—Ç
‚îÇ   ‚îî‚îÄ‚îÄ format.js           # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ webapp/                 # Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îî‚îÄ‚îÄ docs/                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥
2. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ:
   ```bash
   git add .
   git commit -m "–æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
   git push
   ```
3. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   ```bash
   cd ~/recur
   git pull
   docker compose up -d --build
   ```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –ê–≤—Ç–æ—Ä

[@hanumatori](https://t.me/hanumatori)
